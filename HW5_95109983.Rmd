---
title: "Data Analysis Homework 5"
author: "Artin Tajdini 95109983"
date: "March 16, 2018"
output: 
  prettydoc::html_pretty:
    theme: cayman
    highlight: github

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,comment = "",error = F,message = F,
                      warning = F,fig.width = 10,fig.height = 6,fig.align = "center")
library(tidyverse)

```

<div dir="RTL">
#سؤال ۱

برای چک کردن یکی بودن عملکرد شعبه ها باید چک کنیم آیا توزیع فروشش شعبهها با توزیع یونیفرم یکی است یا نه که برای آن از تست 
chi square goodness of fit
استفاده میکنیم که پی ولیو آن کمتر از ۰.۰۵ میشود پس فرض اولیه رد میشود و عملکرد شعبه ها یکی نیست
</div>

```{r}
chisq.test(c(102,300,102,100,205,105,71,92))
```

***

<div dir="RTL">
# سؤال ۲
بدون فرض نرمال بودن داده
میخواهیم یکی بودن فروش در دو حالت را بررسی کنیم از پرمیوتیشن تست پکیج coin 
استفاده میکنیم و پی ولیو بیشتر از ۰.۰۵ میشود پس فرض صفر رد نمیشود و نتیجه میگیریم فروش در هر دو نوع یکی است.
</div>

```{r}
d2 = data.frame(store = c(50, 50, 60, 70, 75, 80, 90, 85, 55, 75, 80, 90, 105, 65))
d2$type = as.factor( c(rep("C", 8), rep("M", 6)) )

coin::oneway_test(store ~ type, data = d2, distribution="exact")
```

***

<div dir="RTL">
# سؤال ۳

می خواهیم ببینیم دو داده یکی هستند یا نه و داده نرمال نیست و همچنین دو داده مچ هستند و ارتباط دارند پس از
Wilcoxon signed-rank test
استفاده میکنیم که د داده را به صورت جفت جفت میکند
پی ولیو بیشتر از ۰.۰۵ میشود پس فرض اولیه رد نمیشود و درنتیج طرح تبلیغ تاثیری در فروش نداشته است.
</div>

```{r}
x3 = c(509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904)
y3 = c(517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901)

wilcox.test(x3, y3, paired = T)
```

***

<div dir="RTL">
# سؤال ۴

میخواهیم ببینیم که آیا توزیع فروش فروشگاه ها بر حسب سه رنگ یکی هست یا نه با فرض نکردن نرمال بودن داده پس از تست کروسکال استفاده میکنیم و پی ولیو بیشتر از ۰.۰۵ است پس فرض صفر رد نمیشود و رنگ در فروش تاثیری ندارد.
</div>

```{r}
d4 = data.frame(store = c(510,720,930,754,105,925,735,753,685,730,745,875,610))
d4$type = factor(c(rep("W", 5), rep("B", 4), rep("R",4)))

kruskal.test(store ~ type, data = d4)
```

***

<div dir="RTL">
# سؤال ۵

میخواهیم ببینیم آیا رضایت در ماه های مختلف یکی است یا نه با فرض نکردن نرمال و داده به صورت
اندازه گیری مکرر است پس از تست فریدمن استفاده میکنیم و پی ولیو بیشتر از ۰.۰۵ است پس فرض صفر رد نمیشود و تبلیغات تاثیری در رضایت نداشته است
</div>

```{r}
d5 = read_csv("data5/tv.csv")
friedman.test(as.matrix(d5))
```

***

<div dir="RTL">
# سؤال ۶

میخواهیم ببینیم که آیا جمعیت شهر روی میزان مصرف تاثیر دادرد یا نه. هر دو متغیر گسسته هستند بنابر این از تست
Chi-squared Test of Independence
استفاده میکنیم و پی ولیو کمتر از ۰.۰۵ میشود بنابراین فرض صفر رد میشود و مستقل بودن این دو متغیر رد میشود پس جمعیت روی میزان مصرف تاثیر دارد
</div>

```{r}
m6 = matrix(c(151,802,753,252,603,55,603,405,408), nrow = 3, byrow = T)
chisq.test(m6)
```

***

<div dir="RTL">
# سؤال ۷

برای پیدا کردن ارتباط بین دو متغیر با فرض نکردن نرمال بودن باید از کورلیشن تست و متد سپیرمن استفاده کنیم و پی ولیو بیشتر از ۰.۰۵ میشود و فرض صفر رد نمیشود پسدو متغیر ارتباطی با یکدیگر ندارند.
</div>

```{r}
d7 = read_csv("data5/consumption.csv")
cor.test(d7$A, d7$B, method = "spearman")
```

***

<div dir="RTL">
# سؤال ۸

میخواهیم ببینیم جنسیت رو معیار خرید تاثیر دارد یا نه و هر دو متغیر گسسته هستند بنابراین از تست
Chi-squared Test of Independence
استفاده میکنیم و پی ولیو کمتر از ۰.۰۵ میشود بنابراین فرض صفر رد میشود و مستقل بودن این دو متغیر رد 
میشود ودرنتیجه جنسیت بر معیار خرید تاثیر دارد.
</div>

```{r}
m8 = matrix(data = c(301, 353, 558, 502, 155, 153), nrow = 3)
chisq.test(m8)

```